name: UE5 Build Test

on:
  workflow_dispatch:  # Manual trigger for testing
  push:
    branches: [ main ]
    paths:
      - 'Source/**'
      - '*.uproject'

jobs:
  build-test:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: Test Build Setup
        run: |
          echo "Project: Adastrea"
          echo "UE Version: 5.6"
          ls -la *.uproject
          
      - name: Validate Project Structure
        run: |
          test -f Adastrea.uproject || exit 1
          test -d Source || exit 1
          test -d Content || exit 1
          echo "‚úì Project structure valid"
      - name: Login to GHCR
        run: echo ${{ secrets.GITHUB_TOKEN }} | docker login ghcr.io -u $GITHUB_ACTOR --password-stdin
        
      - name: Pull UE Container
        run: |
          docker pull ghcr.io/epicgames/unreal-engine:dev-slim-5.6 || {
            echo "‚ùå Container access not configured yet"
            echo "üìñ Setup Guide: ${{ github.server_url }}/${{ github.repository }}/blob/main/GITHUB_TOKEN_DOCKER_SETUP.md"
            echo "Quick fix: Link Epic Games account to GitHub and accept EULA"
            exit 1
          }
